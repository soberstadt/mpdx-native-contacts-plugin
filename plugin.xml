<?xml version='1.0' encoding='utf-8'?>
<plugin id="org.mpdx.nativecontacts" version="0.1.0" xmlns="http://apache.org/cordova/ns/plugins/1.0" xmlns:android="http://schemas.android.com/apk/res/android">
  <name>mpdx-native-contacts</name>
  <js-module name="mpdx-native-contacts" src="www/mpdx-native-contacts.js">
    <clobbers target="cordova.plugins.mpdx-native-contacts" />
  </js-module>
  <platform name="android">
    <config-file parent="/*" target="res/xml/config.xml">
      <feature name="mpdx-native-contacts">
        <param name="android-package" value="org.mpdx.nativecontacts.NativeContactsPlugin" />
      </feature>
    </config-file>

    <config-file parent="/*" target="AndroidManifest.xml">
      <service android:exported="false" android:name="com.mpdx.nativecontacts.NativeContactsService">
        <intent-filter>
          <action android:name="android.accounts.AccountAuthenticator" />
        </intent-filter>
        <meta-data android:name="android.accounts.AccountAuthenticator" android:resource="@xml/authenticator" />
      </service>
      <provider android:authorities="org.mpdx" android:exported="false" android:name=".nativecontacts.ContactsProvider" />
      <service android:exported="true" android:name=".nativecontacts.SyncService">
        <intent-filter>
          <action android:name="android.content.SyncAdapter" />
        </intent-filter>
        <meta-data android:name="android.content.SyncAdapter" android:resource="@xml/syncadapter" />
      </service>
    </config-file>

    <config-file target="AndroidManifest.xml" parent="/*">
      <uses-permission android:name="android.permission.MANAGE_ACCOUNTS" />
      <uses-permission android:name="android.permission.AUTHENTICATE_ACCOUNTS" />
      <uses-permission android:name="android.permission.GET_ACCOUNTS" />
      <uses-permission android:name="android.permission.USE_CREDENTIALS" />
      <uses-permission android:name="android.permission.READ_CONTACTS" />
      <uses-permission android:name="android.permission.WRITE_CONTACTS" />
      <uses-permission android:name="android.permission.READ_SYNC_STATS" />
      <uses-permission android:name="android.permission.WRITE_SYNC_SETTINGS" />
    </config-file>

    <source-file src="src/android/xml/authenticator.xml" target-dir="res/xml" />
    <source-file src="src/android/xml/syncadapter.xml" target-dir="res/xml" />

    <source-file src="src/android/NativeContactsPlugin.java" target-dir="src/org/mpdx/nativecontacts" />
    <source-file src="src/android/ContactsJSONParser.java" target-dir="src/org/mpdx/nativecontacts" />
    <source-file src="src/android/ContactsProvider.java" target-dir="src/org/mpdx/nativecontacts" />
    <source-file src="src/android/SyncAdapter.java" target-dir="src/org/mpdx/nativecontacts" />
    <source-file src="src/android/SyncService.java" target-dir="src/org/mpdx/nativecontacts" />
  </platform>
</plugin>
